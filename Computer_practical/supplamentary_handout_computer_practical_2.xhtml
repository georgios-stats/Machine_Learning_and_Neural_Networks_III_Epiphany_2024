<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.3.7" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>LyX Document</title>
<style type='text/css'>
/* Layout-provided Styles */
ol.lyxlist {
	list-style-type: none;
}
li.labeling_item {
	text-indent: -5em;
	margin-left: 5em;
}
span.lyxlist {
	margin-right: 1em;
}
h2.section_ {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
div.standard {
	margin-bottom: 2ex;
}
h3.subsection_ {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
div.plain_layout {
text-align: left;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
div.Boxed {
	border: solid thick black;
	padding: 0.5ex;
}


</style>
</head>
<body dir="auto">

<ol class='lyxlist' id='magicparlabel-1'><li class="labeling_item"><span class='lyxlist'>Title:</span>
 Supplementary material for computer practical class 2</li>
<li class="labeling_item"><span class='lyxlist'>Author:</span>
 Georgios Karagiannis (georgios.karagiannis@durham.ac.uk) </li>
</ol>
<h2 class="section_" id='magicparlabel-7'>The goal's (roughly speaking...) </h2>
<div class="standard" id='magicparlabel-8'>Consider a Bayesian statistical model <a id="eq_" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi>w</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mover accent='false'><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>i</mi><mi>n</mi><mi>d</mi>
         </mrow>
        </mstyle></mover><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow>
           <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
           </mrow>
          </mrow>
         </msub><mo>|</mo><mi>w</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="6px" /><mspace width="6px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mi>w</mi>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd>(1)
   </mtd>
  </mtr>
 </mtable></math>Here: observables are <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo> &isin; </mo>
     <mstyle mathvariant='script'><mi>Z</mi>
     </mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msubsup>
 </mrow></math> and the unknown parameter is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo>
  </mrow>
 </mrow></math>.</div>

<div class="standard" id='magicparlabel-9'>The likelihood of the observables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo> &isin; </mo>
     <mstyle mathvariant='script'><mi>Z</mi>
     </mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msubsup>
 </mrow></math> given the parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo>
  </mrow>
 </mrow></math> as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>L</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msubsup>
    <mrow><mo> &prod; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>

<div class="standard" id='magicparlabel-10'>the posterior distribution density <a id="eq__1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>w</mi><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>L</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> &int; </mo>
        <msub>
         <mrow><mi>L</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi>w</mi>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>(2)
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_" id='magicparlabel-11'>Goal 1 &nbsp; </h3>
<div class="standard" id='magicparlabel-16'>Find mode of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, that is the Maximum aposteriori estimator (MAP) of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> i.e. <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo>*</mo>
     </mrow>
    </msup>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><munder accent='false'>
     <mrow><mo> arg </mo><mo> max </mo>
     </mrow><mi>w</mi></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

     <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>w</mi><mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><munder accent='false'>
     <mrow><mo> arg </mo><mo> max </mo>
     </mrow>
     <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo>
     </mrow></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><munder accent='false'>
      <munder>
       <mrow>
        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>L</mi>
           </mrow>
           <mrow><mi>n</mi>
           </mrow>
          </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow><mo stretchy="true">&UnderBrace;</mo>
      </munder>
      <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>I</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mstyle></munder><mo>+</mo><munder accent='false'>
      <munder>
       <mrow>
        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow><mo stretchy="true">&UnderBrace;</mo>
      </munder>
      <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>I</mi><mi>I</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mstyle></munder>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>
<h3 class="subsection_" id='magicparlabel-17'>Goal 2 &nbsp; </h3>
<div class="standard" id='magicparlabel-22'>Generate a random sample <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> from <a href="#eq__1">(2)</a>, in particular from <a id="eq__3" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mi> &tau; </mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>w</mi><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi> &tau; </mi>
       </mrow>
      </mfrac>
      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo> &vprop; </mo>
   </mtd>
   <mtd>
    <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi> &tau; </mi>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mi>L</mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(4)
   </mtd>
  </mtr>
 </mtable></math></div>
<h2 class="section_" id='magicparlabel-23'>Stochastic Gradient Langevin Dynamics (SGLD)</h2>
<div class="standard" id='magicparlabel-24'>Provide: </div>

<ul class="itemize" id='magicparlabel-25'><li class="itemize_item">A seed (initial value) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &tau; </mi>
 </mrow></math></li>
<li class="itemize_item">Learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>:</mo>
   <mstyle mathvariant='double-struck'><mi>N</mi>
   </mstyle><mo> &rarr; </mo>
   <msub>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mo>+</mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> ; a positive non-increasing function such as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> &rarr; </mo><mn>0</mn>
  </mrow>
 </mrow></math>. E.g. 

<ul class="itemize" id='magicparlabel-27'><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <msub>
    <mrow><mi>t</mi>
    </mrow>
    <mrow><mn>0</mn>
    </mrow>
   </msub><mo>/</mo><mi>t</mi>
  </mrow>
 </mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>t</mi>
    </mrow>
    <mrow><mn>0</mn>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> user specified </li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>s</mi><mi>o</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>h</mi><mi>i</mi><mi>n</mi><mi>g</mi>&nbsp;<mi>r</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>l</mi><mi>y</mi>&nbsp;<mi>t</mi><mi>i</mi><mi>n</mi><mi>y</mi>
    </mrow>
   </mstyle>
  </mrow>
 </mrow></math></li>
</ul>
</li><li class="itemize_item">Temperature <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math></li>
</ul>
<div class="standard" id='magicparlabel-30'><div class='Boxed'><div class="plain_layout" id='magicparlabel-34'>Stochastic Gradient Langevin Dynamics (SGLD) with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>, batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math>, and temperature <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> is</div>

<div class="plain_layout" id='magicparlabel-35'><hr />

</div>

<ol class="enumerate" id='magicparlabel-36'><li class="enumerate_item">Generate a random set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow>
     <mstyle mathvariant='script'><mi>J</mi>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo> &sube; </mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

     <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> indices from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> with or without replacement, and set a <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>;</mo><mi>i</mi><mo> &isin; </mo>
    <msup>
     <mrow>
      <mstyle mathvariant='script'><mi>J</mi>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>.</li>
<li class="enumerate_item">Compute <a id="eq__7" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>+</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo> &isin; </mo>
         <msup>
          <mrow><mi>J</mi>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msup>
        </mrow>
       </mrow>
      </msub><mi> &nabla; </mi><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo>
       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi> &nabla; </mi><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <msqrt>
      <mrow><mn>2</mn>
       <msub>
        <mrow><mi> &eta; </mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub><mi> &tau; </mi>
      </mrow>
     </msqrt>
     <msub>
      <mrow><mi> &epsi; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(5)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &epsi; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mover accent='false'><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>i</mi><mi>i</mi><mi>d</mi>
    </mrow>
   </mstyle></mover>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo><mi>I</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> .</li>
<li class="enumerate_item">Terminate if a termination criterion is satisfied; E.g., <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &ge; </mo>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>m</mi><mi>a</mi><mi>x</mi>&nbsp;
      </mrow>
     </mstyle>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> for a prespecified <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>m</mi><mi>a</mi><mi>x</mi>&nbsp;
      </mrow>
     </mstyle>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>.</li>
</ol>
</div></div>
</body>
</html>
